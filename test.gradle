test {
    failFast true

    // set heap size for the test JVM(s)
    minHeapSize = "1g"
    maxHeapSize = "4g"

    if (project.hasProperty('arch')) {
        def architecture = project.property('arch').toString().trim()

        if (architecture.equalsIgnoreCase('windows')) {
            exclude '**/KhaiiiTaggerTest.class'
        } else {
            exclude '**/UTaggerTest.class'  // Windows & Ubuntu 18.04
        }
    }

    useJUnitPlatform {
        includeEngines 'spek2'
    }
}

jacoco {
    toolVersion = "0.8.7"
}

jacocoTestReport {
    reports {
        xml.enabled = true
        html.enabled = true
    }
}

tasks.check.dependsOn tasks.clean
tasks.check.dependsOn tasks.jacocoTestReport